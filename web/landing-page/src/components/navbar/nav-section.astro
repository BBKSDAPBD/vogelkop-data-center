---
interface Props {
  title: string;
}

const { title } = Astro.props;
---

<div role="group" aria-labelledby={`nav-section-${title.toLowerCase().replace(/\s+/g, '-')}`} class="flex flex-col">
  <!-- Section header with status dot -->
  <header class="flex items-center gap-2 mb-3">
    <span class="nav-dot relative mt-1 flex h-2 w-2 opacity-0" aria-hidden="true">
      <span class="ping-effect absolute inline-flex h-full w-full rounded-full bg-primary"></span>
      <span class="relative inline-flex rounded-full h-2 w-2 bg-primary shadow-[0_0_8px_primary]"></span>
    </span>
    <h2 
      id={`nav-section-${title.toLowerCase().replace(/\s+/g, '-')}`}
      class="text-xs tracking-widest uppercase"
    >
      {title}
    </h2>
  </header>
  
  <!-- Section content -->
  <div class="flex justify-between flex-1">
    <div class="space-y-2">
      <slot />
    </div>
    <slot name="right" />
  </div>
</div>

<style>
  .nav-dot {
    opacity: 0;
    transition: opacity 0.3s ease;
  }

  .nav-dot.visible {
    opacity: 1;
  }

  .nav-dot.visible .ping-effect {
    animation: ping 1.5s cubic-bezier(0, 0, 0.2, 1) infinite;
  }

  @keyframes ping {
    75%, 100% {
      transform: scale(2);
      opacity: 0;
    }
  }
</style>

<script>
  // Show navbar dots after page loader completes
  function showNavDots() {
    document.querySelectorAll('.nav-dot').forEach(dot => {
      dot.classList.add('visible');
    });
  }

  // Check if loader already completed
  const loader = document.getElementById('page-loader');
  if (loader?.classList.contains('hidden')) {
    showNavDots();
  } else {
    window.addEventListener('pageLoaderComplete', showNavDots, { once: true });
  }
</script>
